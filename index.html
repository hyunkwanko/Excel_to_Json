<!DOCTYPE html>
<html>
    <head>
        <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
        <meta charset="UTF-8">
    </head>
    <body>
        <h1>Excel to Json</h1>
        
        <input type="file" id="getFile" accept=".xls, .xlsx, .txt">
        <button id="button01" onclick="getExcelFile()">Click</button>
        <div id="grid"></div>
    </body>

    <script>
        function getExcelFile() {
            const excelFile = document.getElementById("getFile");
            // console.log(excelFile);
    
            if(excelFile.value === '') {
                alert('Please Select File');
            } else {
                const selectedFile = excelFile.files[0];
                // console.log('Name :' + selectedFile.name + '/ Size : ' + selectedFile.size);
        
                var reader = new FileReader();
        
                reader.onload = function(e) {
                    if(e.target.readyState == FileReader.DONE) {
                        var data = e.target.result;
                        data = new Uint8Array(data);
        
                        // call 'xlsx' to read the file
                        var workbook = XLSX.read(data, {type: 'array'});

                        // console.log(workbook);
                        // console.log(workbook.SheetNames[0]);
                        var first_sheet_name = workbook.SheetNames[0];
                        var address_of_cell = 'C2';

                        /* Get worksheet */
                        var worksheet = workbook.Sheets[first_sheet_name];
                        // console.log(worksheet);

                        /* Find desired cell */
                        var desired_cell = worksheet[address_of_cell];

                        /* Get the value */
                        var desired_value = (desired_cell ? desired_cell.v : undefined);

                        var range = XLSX.utils.decode_range(worksheet['!ref']);
                        // console.log(range);
                        // console.log(range.s.r);
                        // console.log(range.e.r);
                        // console.log(range.s.c);
                        // console.log(range.e.c);

                        for(var R = range.s.r; R <= range.e.r; ++R) {
                            for(var C = range.s.c; C <= range.e.c; ++C) {
                                var cell_address = {c:C, r:R};
                                // console.log(cell_address);
                                /* if an A1-style address is needed, encode the address */
                                var cell_ref = XLSX.utils.encode_cell(cell_address);
                                // console.log(worksheet[cell_ref] ? worksheet[cell_ref].v : undefined);
                            }
                        }

                        for(var R = range.s.r; R <= range.e.r; ++R) {
                            var cell_address = {c:range.s.c, r:R};
                            var cell_ref = XLSX.utils.encode_cell(cell_address);
                            // console.log(cell_ref);
                            console.log(worksheet[cell_ref] ? worksheet[cell_ref].v : undefined);
                        }


                        // console.log(XLSX.utils.sheet_to_formulae(workbook.Sheets['Sheet1'], {header:3}));
                        document.getElementById('grid').innerHTML = XLSX.utils.sheet_to_html(worksheet);
                    }
                };
                reader.readAsArrayBuffer(selectedFile);
            }
        }
    </script>        
</html>
 