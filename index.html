<!DOCTYPE html>
<html>
<head>
    <script src="./js-xlsx-0.14-2.0/dist/xlsx.full.min.js"></script>
    <meta charset="UTF-8">
</head>
<body>
<h1>Hello World!!!</h1>
 
<input type="file" id="selfile" accept=".xls, .xlsx, .txt,">
<button id="btn1" value="Get Excel Data" onclick="getExcelFile()">Click</button>
<div id="grid">
 
</div>
</body>
</html>
 
<script>
    function getExcelFile() {
        const fObj = document.getElementById("selfile");
        // console.log(fObj);
        if(fObj.value === '') {
            alert('Please Select File');
        } else {
            const selectedFile = fObj.files[0];
            console.log(fObj.files);
            // console.log(selectedFile.path);
            // console.log('Name :' + selectedFile.name + '/ Size : ' + selectedFile.size);
 
            var reader = new FileReader();
 
            reader.onload = function(evt) {
                if(evt.target.readyState == FileReader.DONE) {
                    var data = evt.target.result;
                    data = new Uint8Array(data);
 
                    // call 'xlsx' to read the file
                    var workbook = XLSX.read(data, {type: 'array'});
                    // console.log(workbook);
                    var toHtml = XLSX.utils.sheet_to_html(workbook.Sheets['Sheet1'], {header:1});
                    document.getElementById('grid').innerHTML = toHtml;
                }
            };
            reader.readAsArrayBuffer(selectedFile);
        }
    }
</script>
